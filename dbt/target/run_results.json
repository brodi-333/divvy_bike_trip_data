{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.1", "generated_at": "2024-07-11T12:38:36.389327Z", "invocation_id": "d5ea7d8d-4fba-432c-8f70-8fa02b652ca1", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:27:30.444003Z", "completed_at": "2024-07-11T12:27:30.456539Z"}, {"name": "execute", "started_at": "2024-07-11T12:27:30.457598Z", "completed_at": "2024-07-11T12:27:30.678301Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23694229125976562, "adapter_response": {"_message": "SELECT 6574", "code": "SELECT", "rows_affected": 6574}, "message": "SELECT 6574", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_date", "compiled": true, "compiled_code": "WITH recursive date_series AS (\n    SELECT\n        '2013-01-01'::TIMESTAMP AS date_day\n    UNION ALL\n    SELECT\n        date_day + INTERVAL '1 day'\n    FROM\n        date_series\n    WHERE\n        date_day + INTERVAL '1 day' <= '2030-12-31'\n)\n\nSELECT\n    (EXTRACT(YEAR FROM date_day) * 10000 + EXTRACT(MONTH FROM date_day) * 100 + EXTRACT(DAY FROM date_day))::INTEGER AS id,\n    date_day::DATE AS date_day,\n    EXTRACT(YEAR FROM date_day)::INTEGER AS year,\n    EXTRACT(MONTH FROM date_day)::INTEGER AS month,\n    EXTRACT(DAY FROM date_day)::INTEGER AS day,\n    EXTRACT(QUARTER FROM date_day)::INTEGER AS quarter,\n    EXTRACT(ISODOW FROM date_day)::INTEGER AS weekday_iso,\n    TO_CHAR(date_day, 'FMDay') AS weekday_name,\n    TO_CHAR(date_day, 'FMMonth') AS month_name,\n    CASE\n        WHEN EXTRACT(ISODOW FROM date_day)::INTEGER IN(1, 2, 3, 4, 5) THEN 'Weekday'\n        WHEN EXTRACT(ISODOW FROM date_day)::INTEGER IN(6, 7) THEN 'Weekend'\n    END AS weekday_indicator,\n    TO_CHAR(date_day, 'IW')::INTEGER AS week_of_year\nFROM\n    date_series\nORDER BY\n    date_day", "relation_name": "\"airflow\".\"dwh_core\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:27:30.688789Z", "completed_at": "2024-07-11T12:27:30.695813Z"}, {"name": "execute", "started_at": "2024-07-11T12:27:30.697471Z", "completed_at": "2024-07-11T12:27:30.775544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09006428718566895, "adapter_response": {"_message": "SELECT 24", "code": "SELECT", "rows_affected": 24}, "message": "SELECT 24", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_time_of_day", "compiled": true, "compiled_code": "WITH times AS (\n    SELECT\n        generate_series AS time_of_day_hour\n    FROM\n        generate_series(0, 23, 1)\n),\ntime_labels AS (\n    SELECT\n        time_of_day_hour,\n        CASE\n            WHEN time_of_day_hour >= 0 AND time_of_day_hour < 6 THEN 'Night'\n            WHEN time_of_day_hour >= 6 AND time_of_day_hour < 12 THEN 'Morning'\n            WHEN time_of_day_hour >= 12 AND time_of_day_hour < 18 THEN 'Afternoon'\n            WHEN time_of_day_hour >= 18 AND time_of_day_hour <= 23 THEN 'Evening'\n        END AS time_of_day_label\n    FROM\n        times\n)\n\nSELECT\n    time_of_day_hour,\n    time_of_day_label\n\nFROM\n    time_labels", "relation_name": "\"airflow\".\"dwh_core\".\"dim_time_of_day\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:27:30.784153Z", "completed_at": "2024-07-11T12:27:30.789449Z"}, {"name": "execute", "started_at": "2024-07-11T12:27:30.790764Z", "completed_at": "2024-07-11T12:31:52.463420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 261.6818165779114, "adapter_response": {"_message": "SELECT 22928883", "code": "SELECT", "rows_affected": 22928883}, "message": "SELECT 22928883", "failures": null, "unique_id": "model.divvy_bike_trip_data.stg_rides", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT DISTINCT ON (ride_id)\n        ride_id,\n        rideable_type,\n        started_at,\n        ended_at,\n        start_station_name,\n        start_station_id,\n        end_station_name,\n        end_station_id,\n        start_lat,\n        start_lng,\n        end_lat,\n        end_lng,\n        member_casual\n    FROM \"airflow\".\"dwh_staging\".\"raw_rides\"\n    ORDER BY ride_id, started_at\n),\n\nrenamed AS (\n    SELECT\n        ride_id::VARCHAR(16),\n        rideable_type::VARCHAR(32),\n        started_at::TIMESTAMP,\n        ended_at::TIMESTAMP,\n        start_station_name::VARCHAR(120),\n        start_station_id::VARCHAR(50),\n        end_station_name::VARCHAR(120),\n        end_station_id::VARCHAR(50),\n        start_lat::FLOAT,\n        start_lng::FLOAT,\n        end_lat::FLOAT,\n        end_lng::FLOAT,\n        member_casual::VARCHAR(12)\n    FROM source\n)\n\nSELECT *\nFROM renamed", "relation_name": "\"airflow\".\"dwh_staging\".\"stg_rides\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:31:52.472551Z", "completed_at": "2024-07-11T12:31:52.479328Z"}, {"name": "execute", "started_at": "2024-07-11T12:31:52.480115Z", "completed_at": "2024-07-11T12:31:52.569109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10008597373962402, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_ended_at_date", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT * FROM \"airflow\".\"dwh_core\".\"dim_date\"\n)\n\nSELECT * FROM base", "relation_name": "\"airflow\".\"dwh_core\".\"dim_ended_at_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:31:52.579990Z", "completed_at": "2024-07-11T12:31:52.586976Z"}, {"name": "execute", "started_at": "2024-07-11T12:31:52.588046Z", "completed_at": "2024-07-11T12:31:52.651799Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07532215118408203, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_started_at_date", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT * FROM \"airflow\".\"dwh_core\".\"dim_date\"\n)\n\nSELECT * FROM base", "relation_name": "\"airflow\".\"dwh_core\".\"dim_started_at_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:31:52.662786Z", "completed_at": "2024-07-11T12:31:52.669173Z"}, {"name": "execute", "started_at": "2024-07-11T12:31:52.670138Z", "completed_at": "2024-07-11T12:31:52.732119Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07245063781738281, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_ended_at_time_of_day", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT * FROM \"airflow\".\"dwh_core\".\"dim_time_of_day\"\n)\n\nSELECT * FROM base", "relation_name": "\"airflow\".\"dwh_core\".\"dim_ended_at_time_of_day\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:31:52.749330Z", "completed_at": "2024-07-11T12:31:52.759598Z"}, {"name": "execute", "started_at": "2024-07-11T12:31:52.760987Z", "completed_at": "2024-07-11T12:31:52.825364Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0806884765625, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_started_at_time_of_day", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT * FROM \"airflow\".\"dwh_core\".\"dim_time_of_day\"\n)\n\nSELECT * FROM base", "relation_name": "\"airflow\".\"dwh_core\".\"dim_started_at_time_of_day\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:31:52.833785Z", "completed_at": "2024-07-11T12:31:52.839252Z"}, {"name": "execute", "started_at": "2024-07-11T12:31:52.840396Z", "completed_at": "2024-07-11T12:32:21.187042Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 28.356305599212646, "adapter_response": {"_message": "SELECT 2", "code": "SELECT", "rows_affected": 2}, "message": "SELECT 2", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_rent_type", "compiled": true, "compiled_code": "WITH rent_types AS (\n    SELECT\n        ROW_NUMBER() OVER (ORDER BY member_casual) AS id,\n        member_casual AS name\n    FROM\n        \"airflow\".\"dwh_staging\".\"stg_rides\"\n    GROUP BY member_casual\n    ORDER BY member_casual\n)\n\nSELECT * FROM rent_types", "relation_name": "\"airflow\".\"dwh_core\".\"dim_rent_type\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:32:21.202245Z", "completed_at": "2024-07-11T12:32:21.211754Z"}, {"name": "execute", "started_at": "2024-07-11T12:32:21.212490Z", "completed_at": "2024-07-11T12:32:24.179188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.9801270961761475, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_rideable_type", "compiled": true, "compiled_code": "WITH rideable_types AS (\n    SELECT\n        ROW_NUMBER() OVER (ORDER BY rideable_type) AS id,\n        rideable_type AS name\n    FROM\n        \"airflow\".\"dwh_staging\".\"stg_rides\"\n    GROUP BY rideable_type\n    ORDER BY rideable_type\n)\n\nSELECT * FROM rideable_types", "relation_name": "\"airflow\".\"dwh_core\".\"dim_rideable_type\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:32:24.186834Z", "completed_at": "2024-07-11T12:32:24.211874Z"}, {"name": "execute", "started_at": "2024-07-11T12:32:24.212504Z", "completed_at": "2024-07-11T12:34:22.861751Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 118.67855334281921, "adapter_response": {"_message": "SELECT 2716", "code": "SELECT", "rows_affected": 2716}, "message": "SELECT 2716", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_station", "compiled": true, "compiled_code": "WITH start_stations AS (\n    SELECT DISTINCT ON (start_station_id)\n        md5(cast(coalesce(cast(start_station_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS station_pk,\n        start_station_id AS id,\n        start_station_name AS name,\n        started_at AS created_at\n    FROM\n        \"airflow\".\"dwh_staging\".\"stg_rides\"\n    ORDER BY\n        start_station_id,\n        started_at\n),\nend_stations AS (\n    SELECT DISTINCT ON (end_station_id)\n        md5(cast(coalesce(cast(end_station_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS station_pk,\n        end_station_id AS id,\n        end_station_name AS name,\n        ended_at AS created_at\n    FROM\n        \"airflow\".\"dwh_staging\".\"stg_rides\"\n    ORDER BY\n        end_station_id,\n        ended_at\n)\n\nSELECT DISTINCT ON (id)\n    t.station_pk,\n    COALESCE(t.id, '-1') AS id,\n    COALESCE(t.name, '-1') AS name\nFROM (\n    SELECT *\n    FROM start_stations\n\n    UNION\n\n    SELECT *\n    FROM end_stations\n\n    UNION\n\n    SELECT\n        '-1' AS station_pk,\n        '-1' AS id,\n        'Empty' AS name,\n        NOW() AS created_at\n) t\nORDER BY\n    id DESC,\n    created_at DESC", "relation_name": "\"airflow\".\"dwh_core\".\"dim_station\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:34:22.872765Z", "completed_at": "2024-07-11T12:34:22.882004Z"}, {"name": "execute", "started_at": "2024-07-11T12:34:22.882952Z", "completed_at": "2024-07-11T12:34:22.926761Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05712175369262695, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_end_station", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT * FROM \"airflow\".\"dwh_core\".\"dim_station\"\n)\n\nSELECT * FROM base", "relation_name": "\"airflow\".\"dwh_core\".\"dim_end_station\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:34:22.935687Z", "completed_at": "2024-07-11T12:34:22.941316Z"}, {"name": "execute", "started_at": "2024-07-11T12:34:22.942084Z", "completed_at": "2024-07-11T12:34:22.987354Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05419635772705078, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.divvy_bike_trip_data.dim_start_station", "compiled": true, "compiled_code": "\n\nWITH base AS (\n    SELECT * FROM \"airflow\".\"dwh_core\".\"dim_station\"\n)\n\nSELECT * FROM base", "relation_name": "\"airflow\".\"dwh_core\".\"dim_start_station\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T12:34:22.997459Z", "completed_at": "2024-07-11T12:34:23.020550Z"}, {"name": "execute", "started_at": "2024-07-11T12:34:23.021296Z", "completed_at": "2024-07-11T12:38:36.370627Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 253.37658190727234, "adapter_response": {"_message": "SELECT 22914833", "code": "SELECT", "rows_affected": 22914833}, "message": "SELECT 22914833", "failures": null, "unique_id": "model.divvy_bike_trip_data.fct_rides", "compiled": true, "compiled_code": "WITH rides AS (\n    SELECT\n        ride_id,\n        rideable_type,\n        (EXTRACT(YEAR FROM started_at) * 10000\n            + EXTRACT(MONTH FROM started_at) * 100\n            + EXTRACT(DAY FROM started_at))::INTEGER AS started_at_date,\n        (EXTRACT(YEAR FROM ended_at) * 10000\n            + EXTRACT(MONTH FROM ended_at) * 100\n            + EXTRACT(DAY FROM ended_at))::INTEGER AS ended_at_date,\n        EXTRACT(HOUR FROM started_at)::INTEGER AS started_at_hour,\n        EXTRACT(HOUR FROM ended_at)::INTEGER AS ended_at_hour,\n        DATE_TRUNC('second', started_at) AS started_at,\n        DATE_TRUNC('second', ended_at) AS ended_at,\n        start_station_id,\n        end_station_id,\n        start_lat,\n        start_lng,\n        end_lat,\n        end_lng,\n        member_casual\n    FROM\n        \"airflow\".\"dwh_staging\".\"stg_rides\"\n),\nrideable_types AS (\n    SELECT\n        id,\n        name\n    FROM \"airflow\".\"dwh_core\".\"dim_rideable_type\"\n),\nstarted_at_dates AS (\n    SELECT\n        id\n    FROM \"airflow\".\"dwh_core\".\"dim_started_at_date\"\n),\nended_at_dates AS (\n    SELECT\n        id\n    FROM \"airflow\".\"dwh_core\".\"dim_ended_at_date\"\n),\nstarted_at_times AS (\n    SELECT\n        time_of_day_hour,\n        time_of_day_label\n    FROM \"airflow\".\"dwh_core\".\"dim_started_at_time_of_day\"\n),\nended_at_times AS (\n    SELECT\n        time_of_day_hour,\n        time_of_day_label\n    FROM \"airflow\".\"dwh_core\".\"dim_ended_at_time_of_day\"\n),\nstart_stations AS (\n    SELECT\n        station_pk,\n        id,\n        name\n    FROM \"airflow\".\"dwh_core\".\"dim_start_station\"\n),\nend_stations AS (\n    SELECT\n        station_pk,\n        id,\n        name\n    FROM \"airflow\".\"dwh_core\".\"dim_end_station\"\n),\nrent_types AS (\n    SELECT\n        id,\n        name\n    FROM \"airflow\".\"dwh_core\".\"dim_rent_type\"\n)\n\nSELECT\n    r.ride_id,\n    rt.id AS rideable_type_fk,\n    started_at_date_d.id AS started_at_date_fk,\n    ended_at_date_d.id AS ended_at_date_fk,\n    started_at_time_d.time_of_day_hour AS started_at_time_of_day_fk,\n    ended_at_time_d.time_of_day_hour AS ended_at_time_of_day_fk,\n    r.started_at AS started_at_datetime,\n    r.ended_at AS ended_at_datetime,\n    \n        (\n        (\n        (\n        ((r.ended_at)::date - (r.started_at)::date)\n     * 24 + date_part('hour', (r.ended_at)::timestamp) - date_part('hour', (r.started_at)::timestamp))\n     * 60 + date_part('minute', (r.ended_at)::timestamp) - date_part('minute', (r.started_at)::timestamp))\n     * 60 + floor(date_part('second', (r.ended_at)::timestamp)) - floor(date_part('second', (r.started_at)::timestamp)))\n     AS duration_in_seconds,\n    COALESCE(ss.station_pk, '-1') AS start_station_fk,\n    COALESCE(es.station_pk, '-1') AS end_station_fk,\n    r.start_lat,\n    r.start_lng,\n    r.end_lat,\n    r.end_lng,\n    ret.id AS rent_type_fk\nFROM\n    rides r\nLEFT JOIN rideable_types rt\n    ON r.rideable_type = rt.name\nLEFT JOIN started_at_dates started_at_date_d\n    ON r.started_at_date = started_at_date_d.id\nLEFT JOIN ended_at_dates ended_at_date_d\n    ON r.ended_at_date = ended_at_date_d.id\nLEFT JOIN started_at_times started_at_time_d\n    ON r.started_at_hour = started_at_time_d.time_of_day_hour\nLEFT JOIN ended_at_times ended_at_time_d\n    ON r.ended_at_hour = ended_at_time_d.time_of_day_hour\nLEFT JOIN start_stations ss\n    ON r.start_station_id = ss.id\nLEFT JOIN end_stations es\n    ON r.end_station_id = es.id\nLEFT JOIN rent_types ret\n    ON r.member_casual = ret.name\nWHERE r.ended_at > r.started_at", "relation_name": "\"airflow\".\"dwh_core\".\"fct_rides\""}], "elapsed_time": 666.2557995319366, "args": {"show_resource_report": false, "invocation_command": "dbt run", "profiles_dir": "/home/pawe/.dbt", "source_freshness_run_project_hooks": false, "print": true, "use_colors": true, "log_file_max_bytes": 10485760, "macro_debugging": false, "favor_state": false, "use_colors_file": true, "which": "run", "log_level": "info", "populate_cache": true, "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "partial_parse": true, "project_dir": "/media/pawe/d/www/py/divvy_bike_trip_data/dbt", "static_parser": true, "exclude": [], "partial_parse_file_diff": true, "version_check": true, "strict_mode": false, "write_json": true, "printer_width": 80, "quiet": false, "log_format_file": "debug", "log_level_file": "debug", "select": [], "cache_selected_only": false, "vars": {}, "require_explicit_package_overrides_for_builtin_materializations": true, "indirect_selection": "eager", "require_resource_names_without_spaces": false, "log_path": "/media/pawe/d/www/py/divvy_bike_trip_data/dbt/logs", "defer": false, "enable_legacy_logger": false, "empty": false, "log_format": "default"}}